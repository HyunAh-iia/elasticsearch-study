## 목차

1. [검색 엔진과 검색 시스템](#content-1)
2. [검색 시스템의 구성요소](#content-2)
3. [관계형 데이터베이스와의 비교](#content-3)
4. [엘라스틱서치의 강점](#content-4)
5. [엘라스틱서치의 약점](#content-5)

<a id="content-1"></a>

## 1. 검색 엔진과 검색 시스템

### **검색 엔진**

- 웹에서 정보를 수집하고 그 검색 결과를 제공하는 프로그램
- 엘라스틱 서치는 엄밀히 말하자면 검색엔진

### **검색 시스템**

- 대용량 데이터를 기반으로 신뢰성 있는 검색 결과를 제공하기 위해 검색엔진을 기반으로 구축된 시스템을 통칭하는 용어
- 데이터 수집, 색인, UI 제공, 관련도가 높은 문서 검색, 가중치를 이용한 검색의 정확도 증가 등을 모두 포함
- 검색 엔진보다 큰 범위의 개념
- 검색 서비스(ex. naver, google)를 제공하기 위해서는 검색 엔진을 기반으로 구축한 검색 시스템을 활용 해야함

```text
검색 서비스 > 검색 시스템 > 검색 엔진
```

<a id="content-2"></a>

## 2. 검색 시스템의 구성 요소

> 검색 시스템의 구성요소로는 정보를 수집하는 수집기, 수집한 데이터를 검색에 적절한 형태로 변환하는 색인기, 검색에 적절한 형태로 변환된 데이터를 보관하는 스토리지, 스토리지에 저장된 데이터에서 검색하는 검색기가 있다.

### **수집기**

- 웹에서 필요한 정보를 수집하는 프로그램
- 수집 대상 : 파일, 데이터베이스, 웹 페이지 등 웹상의 대부분의 정보
- 크롤러(Crawler), 스파이더(Spider), 웹 로봇(Web Robot) 등으로 불림

### **색인기**

- 수집한 정보를 검색 가능한 구조로 가공하는 역할을 함
- 다양한 형태소 분석기를 조합해 의미있는 용어를 추출하고 검색에 유리한 역색인(Inverted index) 구조로 데이터를 저장

### **스토리지**

- 데이터를 저장하는 물리적인 저장소
- 색인된 데이터를 이곳에 저장함

### **검색기**

- 사용자 질의를 입력받아 저장된 데이터에서 일치하는 문서를 찾아 결과로 반환
- 일치 여부는 유사도 기반의 검색 순위 알고리즘으로 판단
- 검색기 또한 색인기와 마찬가지로 형태소 분석기를 이용

<a id="content-3"></a>

## 3. 관계형 데이터베이스와의 비교

### **공통점**

- 둘 다 질의와 일치하는 데이터를 검색 및 제공함

### **차이점**

- 관계형 데이터베이스
  - 데이터의 중복을 제거하고 **정형** 데이터로 구조화해 행과 열로 구성된 테이블에 저장하고 SQL문을 이용해 텍스트 매칭을 통한 단순 검색이 가능
- 엘라스틱서치
  - **비정형** 데이터를 색인하고, 형태소 분석을 통해 자연어 처리가 가능하고 역색인 구조를 바탕으로 빠른 검색 속도를 보장

### **대조되는 핵심 요소들**

| 관계형 데이터베이스       | 엘라스틱서치       |
| ---------------- | ------------ |
| 데이터베이스(Database) | 인덱스(Index)   |
| 파티션(Partition)   | 샤드(Shard)    |
| 테이블(Table)       | 타입(Type)     |
| 행(Row)           | 문서(Document) |
| 열(Column)        | 필드(Field)    |
| 스키마(Schema)      | 매핑(Mapping)  |
| SQL              | Query DSL    |

### **CRUD**

> 관계형 데이터베이스는 SQL 문으로 질의를 하고 행으로 결과를 얻는다.
>
> 엘라스틱 서치는 기본적으로 RESTful API를 사용하고 JSON 형태의 문서로 결과를 얻는다.

| 엘라스틱서치 API | 기능               | 관계형 데이터베이스 SQL |
| ---------- | ---------------- | -------------- |
| GET        | 조회               | SELECT         |
| PUT        | 생성               | CREATE         |
| POST       | 인덱스 업데이트, 데이터 조회 | UPDATE, SELECT |
| DELETE     | 삭제               | DELETE         |
| HEAD       | 인덱스 정보 확인        | -              |

<a id="content-4"></a>

## 4. 엘라스틱서치의 강점

### 1. 오픈소스 검색 엔진

- 엘라스틱서치는 아파치 재단의 루씬(Lucene)을 기반으로 개발된 오픈소스 검색엔진이다.
- github start도 47.7k고 51,237번의 commit이 이뤄졌으며 269번 releases가 되었다.
- 가장 최근에 올라온 이슈가 2020년 3월 21일 저녁 7시를 기준으로 12시간 전이다.
- Contributors는 1,378명이고, 한 명의 maintainer에게 편중되어 있지도 않다.
- 2010년 0.4.0 버전의 릴리즈를 이어 지금까지 계속 발전하고 있는것으로 보아 엘라스틱서치는 굉장히 성숙도가 있는 오픈소스인것을 알 수 있다.

### 2. 전문 검색(Full Text)

- 엘라스틱서치는 다양한 기능별, 언어별 플러그인을 조합해 전문 검색이 가능하다.

### 3. 통계 분석

- 비정형 로그 데이터를 수집하여 통계 분석할 수 있다.
- 사용되는 Helper Tool은 키바나(Kibana)가 있다.

### 4. Schemaless

- 엘라스틱서치는 스키마가 존재하지 않기때문에 비정형 데이터를 색인하고 검색 할 수 있다.

### 5. RESTful API

- 엘라스틱서치는 HTTP 기반의 RESTful API를 지원하고 요청 및 응답에 JSON 형식을 사용하기 떄문에 표준만 맞춘다면 시스템에 관계없이 이용 가능하다.

### 6. Multi-tenancy

- 서로 상이한 인덱스일지라도 검색할 필드명만 같으면 여러 인덱스를 같이 조회할 수 있다.

### 7. Document-Oriented

- 여러 계층의 데이터를 JSON 형식의 문서로 인덱스에 저장 할 수 있고 한 번의 쿼리로 조회가 가능하다.

### 8. 역색인(Inverted Index)

- MongoDB, Cassandra 같은 일반적인 NoSQL은 역색인을 지원하지 않는다. 하지만 엘라스틱서치는 역색인을 지원한다.

### 9. 확장성(Scalability) & 가용성(Availability)

- 덩치가 큰 데이터를 색인한다면 큰 비용이 든다. 이럴때 샤드(Shard) 라는 작은 단위로 나눠서 분산 처리 할 수 있다.
- 인덱스를 만들 때마다 샤드의 수를 조절할 수 있다.

<a id="content-5"></a>

## 5. 엘라스틱서치의 약점

### 1. RealTime이 아니다

- 색인된 데이터는 통상 1초 뒤에나 검색이 가능하다.
- 내부적으로 Commit과 Flush같은 복잡한 과정을 거치기 때문..
- NearTime이라고 할 수 있다.

### 2. Transaction & Rollback을 지원하지 않는다

- 엘라스틱서치는 기본적으로 분산 시스템으로 구성되기에 클러스터의 성능 향상을 위해 비용이 큰 Transaction과 Rollback을 지원하지 않는다.
- 데이터 손실의 위험이 있다.

### 3. 데이터 update를 제공하지 않는다

- 엘라스틱서치는 업데이트 요청이 오면 기존 데이터를 삭제하고 변경된 내용으로 다시 생성한다.
- 업데이트 비용이 상대적으로 크다.
- 대신 데이터가 Immutable하다
